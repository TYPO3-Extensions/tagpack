var Mediabox;(function(){var l=0,R,H,c,W,b,K,P,N,Q=new Image(),j=new Image(),g,B,J,d,C,i,U,Y,h,k,E,T,e,V,S,L,I="none",F,D="mediaBox";window.addEvent("domready",function(){$(document.body).adopt($$([g=new Element("div",{id:"mbOverlay"}).addEvent("click",a),B=new Element("div",{id:"mbCenter"}),d=new Element("div",{id:"mbBottomContainer"})]).setStyle("display","none"));J=new Element("div",{id:"mbImage"}).injectInside(B);C=new Element("div",{id:"mbBottom"}).injectInside(d).adopt(new Element("a",{id:"mbCloseLink",href:"#"}).addEvent("click",a),E=new Element("a",{id:"mbNextLink",href:"#"}).addEvent("click",G),h=new Element("a",{id:"mbPrevLink",href:"#"}).addEvent("click",Z),U=new Element("div",{id:"mbTitle"}),k=new Element("div",{id:"mbNumber"}),Y=new Element("div",{id:"mbCaption"}),new Element("div",{styles:{clear:"both"}}));P={overlay:new Fx.Tween(g,{property:"opacity",duration:360}).set(0),image:new Fx.Tween(J,{property:"opacity",duration:360,onComplete:f}),bottom:new Fx.Tween(C,{property:"margin-top",duration:240})}});Mediabox={open:function(p,o,m){R=$extend({loop:false,overlayOpacity:0.8,resizeDuration:240,resizeTransition:false,initialWidth:320,initialHeight:180,showCaption:true,animateCaption:true,showCounter:true,counterText:"  ({x} of {y})",scriptaccess:"true",fullscreen:"true",fullscreenNum:"1",autoplay:"true",autoplayNum:"1",bgcolor:"#000000",playerpath:"../mediaplayer/player.swf",backcolor:"000000",frontcolor:"999999",lightcolor:"000000",screencolor:"000000",controlbar:"over",controller:"true",flInfo:"true",revverID:"187866",revverFullscreen:"true",revverBack:"000000",revverFront:"ffffff",revverGrad:"000000",ytColor1:"000000",ytColor2:"333333",vmTitle:"1",vmByline:"1",vmPortrait:"1",vmColor:"ffffff"},m||{});if(typeof p=="string"){p=[[p,o,m]];o=0}if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){var n=new Number(RegExp.$1);if(n<3){R.overlayOpacity=1;g.className="mbOverlayFF"}}if(Browser.Engine.trident4){R.overlayOpacity=1;g.className="mbOverlayIE"}H=p;R.loop=R.loop&&(H.length>1);X();M(true);K=window.getScrollTop()+(window.getHeight()/15);P.resize=new Fx.Morph(B,$extend({duration:R.resizeDuration,onComplete:f},R.resizeTransition?{transition:R.resizeTransition}:{}));B.setStyles({top:K,width:R.initialWidth,height:R.initialHeight,marginLeft:-(R.initialWidth/2),display:""});P.overlay.start(R.overlayOpacity);l=1;return A(o)}};Element.implement({mediabox:function(m,n){$$(this).mediabox(m,n);return this}});Elements.implement({mediabox:function(m,p,o){p=p||function(q){return[q.href,q.title,q.rel]};o=o||function(){return true};var n=this;n.removeEvents("click").addEvent("click",function(){var q=n.filter(o,this);return Mediabox.open(q.map(p),q.indexOf(this),m)});return n}});function X(){g.setStyles({top:window.getScrollTop(),height:window.getHeight()})}function M(m){["object",window.ie?"select":"embed"].forEach(function(o){Array.forEach(document.getElementsByTagName(o),function(p){if(m){p._mediabox=p.style.visibility}p.style.visibility=m?"hidden":p._mediabox})});g.style.display=m?"":"none";var n=m?"addEvent":"removeEvent";window[n]("scroll",X)[n]("resize",X);document[n]("keydown",O)}function O(m){switch(m.code){case 27:case 88:case 67:a();break;case 37:case 80:Z();break;case 39:case 78:G()}}function Z(){return A(W)}function G(){return A(b)}function A(m){if((l==1)&&(m>=0)){l=2;J.set("html","");c=m;W=((c||!R.loop)?c:H.length)-1;b=c+1;if(b==H.length){b=R.loop?0:-1}$$(h,E,J,d).setStyle("display","none");P.bottom.cancel().set(0);P.image.set(0);B.className="mbLoading";e=H[m][2].match(/[0-9]+/g);if(e){V=e.length;S=e[V-2]+"px";L=e[V-1]+"px"}else{S=R.initialWidth;S=R.initialWidth}T=H[m][0];i=H[c][1].split("::");if(T.match(/\.gif|\.jpg|\.png/i)){I="img";N=new Image();N.onload=f;N.src=H[m][0]}else{if(T.match(/\.flv|\.mp4/i)){I="obj";N=new Swiff(""+R.playerpath+"?file="+T+"&backcolor="+R.backcolor+"&frontcolor="+R.frontcolor+"&lightcolor="+R.lightcolor+"&screencolor="+R.screencolor+"&autostart="+R.autoplay+"&controlbar="+R.controlbar,{id:"MediaboxSWF",width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/\.mp3|\.aac/i)){I="obj";N=new Swiff(""+R.playerpath+"?file="+T+"&backcolor="+R.backcolor+"&frontcolor="+R.frontcolor+"&lightcolor="+R.lightcolor+"&screencolor="+R.screencolor+"&autostart="+R.autoplay,{id:"MediaboxSWF",width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/\.swf/i)){I="obj";N=new Swiff(T,{id:"MediaboxSWF",width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/dailymotion\.com/i)){I="obj";N=new Swiff(T,{id:D,width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/flickr\.com/i)){I="obj";F=T.split("/");D=F[5];N=new Swiff("http://www.flickr.com/apps/video/stewart.swf",{id:D,classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",width:S,height:L,params:{flashvars:"photo_id="+D+"&show_info_box="+R.flInfo,wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/google\.com\/videoplay/i)){I="obj";F=T.split("=");D=F[1];N=new Swiff("http://video.google.com/googleplayer.swf?docId="+D+"&autoplay="+R.autoplayNum,{id:D,width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/metacafe\.com\/watch/i)){I="obj";F=T.split("/");D=F[4];N=new Swiff("http://www.metacafe.com/fplayer/"+D+"/.swf",{id:D,width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/myspacetv\.com|vids\.myspace\.com/i)){I="obj";F=T.split("=");D=F[2];N=new Swiff("http://lads.myspace.com/videos/vplayer.swf?m="+D+"&v=2&type=video",{id:D,width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/revver\.com/i)){I="obj";F=T.split("/");D=F[4];N=new Swiff("http://flash.revver.com/player/1.0/player.swf?mediaId="+D+"&affiliateId="+R.revverID+"&allowFullScreen="+R.revverFullscreen+"&backColor=#"+R.revverBack+"&frontColor=#"+R.revverFront+"&gradColor=#"+R.revverGrad+"&shareUrl=revver",{id:D,width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/seesmic\.com/i)){I="obj";F=T.split("/");D=F[5];N=new Swiff("http://seesmic.com/Standalone.swf?video="+D,{id:D,width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/youtube\.com/i)){I="obj";F=T.split("=");D=F[1];N=new Swiff("http://www.youtube.com/v/"+D+"&autoplay="+R.autoplayNum+"&fs="+R.fullscreenNum+"&color1=0x"+R.ytColor1+"&color2=0x"+R.ytColor2,{id:D,width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/veoh\.com/i)){I="obj";F=T.split("videos/");D=F[1];N=new Swiff("http://www.veoh.com/videodetails2.swf?permalinkId="+D+"&player=videodetailsembedded&videoAutoPlay="+R.AutoplayNum,{id:D,width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/viddler\.com/i)){I="obj";F=T.split("/");D=F[4];N=new Swiff("http://www.viddler.com/player/e5398221/",{name:"viddler_"+D+"_"+F[6],id:D,classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/vimeo\.com/i)){I="obj";F=T.split("/");D=F[3];N=new Swiff("http://www.vimeo.com/moogaloop.swf?clip_id="+D+"&server=www.vimeo.com&fullscreen="+R.fullscreenNum+"&show_title="+R.vmTitle+"&show_byline="+R.vmByline+"&show_portrait="+R.vmPortrait+"&color="+R.vmColor,{id:D,width:S,height:L,params:{wmode:"opaque",bgcolor:R.bgcolor,allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/12seconds\.tv/i)){I="obj";F=T.split("/");D=F[5];N=new Swiff("http://embed.12seconds.tv/players/remotePlayer.swf",{id:D,width:S,height:L,params:{flashvars:"vid="+D+"",wmode:"opaque",bgcolor:"#ffffff",allowscriptaccess:R.scriptaccess,allowfullscreen:R.fullscreen}});f()}else{if(T.match(/\#mb_/i)){I="inline";URLsplit=T.split("#");N=$(URLsplit[1]).get("html");f()}else{I="url";D="mediaId_"+new Date().getTime();N=new Element("iframe",{"src":T,"id":D,"width":S,"height":L,"frameborder":0});f()}}}}}}}}}}}}}}}}}}return false}function f(){switch(l++){case 2:if(I=="img"){S=N.width;L=N.height;J.setStyles({backgroundImage:"url("+T+")",display:""})}else{if(I=="obj"){if(Browser.Plugins.Flash.version<8){J.setStyles({backgroundImage:"none",display:""});J.set("html",'<div id="mbError"><b>Error</b><br/>Adobe Flash is either not installed or not up to date,<br/>please visit <a href="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" title="Get Flash" target="_new">Adobe.com</a> to download the free player.</div>')}else{J.setStyles({backgroundImage:"none",display:""});N.inject(J)}}else{if(I=="inline"){J.setStyles({backgroundImage:"none",display:""});J.set("html",N)}else{if(I=="url"){J.setStyles({backgroundImage:"none",display:""});N.inject(J)}else{alert("this file type is not supported\n"+T+"\nplease visit iaian7.com/webcode/Mediabox for more information")}}}}$$(J,C).setStyle("width",S);J.setStyle("height",L);U.set("html",(R.showCaption&&(i.length>1))?i[0]:H[c][1]);Y.set("html",(R.showCaption&&(i.length>1))?i[1]:"");k.set("html",(R.showCounter&&(H.length>1))?R.counterText.replace(/{x}/,c+1).replace(/{y}/,H.length):"");if((W>=0)&&(H[W][0].match(/\.gif|\.jpg|\.png/i))){Q.src=H[W][0]}if((b>=0)&&(H[b][0].match(/\.gif|\.jpg|\.png/i))){j.src=H[b][0]}l++;case 3:B.className="";P.resize.start({height:J.offsetHeight,width:J.offsetWidth,marginLeft:-J.offsetWidth/2});break;l++;case 4:d.setStyles({top:K+B.clientHeight,marginLeft:B.style.marginLeft,visibility:"hidden",display:""});P.image.start(1);break;case 5:if(W>=0){h.style.display=""}if(b>=0){E.style.display=""}if(R.animateCaption){P.bottom.set(-C.offsetHeight).start(0)}d.style.visibility="";l=1}}function a(){if(l){l=0;N.onload=$empty;J.set("html","");for(var m in P){P[m].cancel()}$$(B,d).setStyle("display","none");P.overlay.chain(M).start(0)}return false}})()